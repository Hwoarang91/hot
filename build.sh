#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞ HotWalletClaimer
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

set -e

echo "======================================================================"
echo "üê≥ –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞ HotWalletClaimer"
echo "======================================================================"
echo ""

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
ARCH=$(uname -m)
echo "üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: $ARCH"
echo ""

# –í—ã–±–æ—Ä Dockerfile
if [ "$ARCH" = "x86_64" ] || [ "$ARCH" = "amd64" ]; then
    DOCKERFILE="docker/Dockerfile.amd64"
    echo "‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é Dockerfile –¥–ª—è AMD64/Intel"
elif [ "$ARCH" = "aarch64" ] || [ "$ARCH" = "arm64" ]; then
    DOCKERFILE="docker/Dockerfile.arm64"
    echo "‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é Dockerfile –¥–ª—è ARM64"
else
    echo "‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: $ARCH"
    echo "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: x86_64 (amd64), aarch64 (arm64)"
    exit 1
fi

echo ""
echo "======================================================================"
echo "üî® –ù–∞—á–∏–Ω–∞—é —Å–±–æ—Ä–∫—É –æ–±—Ä–∞–∑–∞..."
echo "======================================================================"
echo ""

# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -f "$DOCKERFILE" -t hwoarang91/hot-wallet-claimer:latest .

echo ""
echo "======================================================================"
echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!"
echo "======================================================================"
echo ""

# –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—Ä–∞–∑–µ
docker images | grep hwoarang91/hot-wallet-claimer

echo ""
echo "======================================================================"
echo "üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "======================================================================"
echo ""
echo "1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:"
echo "   docker-compose up -d"
echo ""
echo "2. –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:"
echo "   docker run -d --name hot-wallet-claimer hwoarang91/hot-wallet-claimer:latest"
echo ""
echo "3. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:"
echo "   docker logs -f hot-wallet-claimer"
echo ""
echo "4. –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ Docker Hub:"
echo "   docker login"
echo "   docker push hwoarang91/hot-wallet-claimer:latest"
echo ""
echo "======================================================================"
