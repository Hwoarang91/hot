# Управление дисковым пространством путем настройки логов PM2.

Если на машине, где вы запускаете скрипты, ограничено место на жестком диске, вам нужно скорректировать количество запускаемых игр, чтобы уложиться в ограничения вашего оборудования. Каждая игровая сессия занимает от 100 до 400 МБ дискового пространства, в зависимости от запускаемой игры. Большая часть места занимает файл кэша браузера, который хранит копию игровых ресурсов на вашем устройстве, чтобы избежать их повторной загрузки каждый раз. Кроме того, PM2 будет сохранять логи о ходе ваших заявок, поэтому вам может понадобиться использовать метод, подобный приведенному ниже, для управления или курирования логов.

Мы не знаем и не контролируем размер вашего оборудования или количество устанавливаемых вами скриптов. Каждый пользователь должен самостоятельно следить за ресурсами своего оборудования и обеспечивать возможность запуска нужного количества скриптов.

Если место на жестком диске является ограничивающим фактором, вы можете настроить PM2 для ротации логов. В этом примере каждому процессу разрешается хранить до 10 логов размером по 1 МБ, хотя большинство из них будет сжато. Это максимальный размер лога для КАЖДОГО процесса, отображаемого при вводе команды `pm2 list`.

Пример:
```
pm2 set pm2-logrotate:max_size 1M
pm2 set pm2-logrotate:retain 10
pm2 set pm2-logrotate:compress true
pm2 set pm2-logrotate:dateFormat 'YYYY-MM-DD_HH-mm-ss'
pm2 set pm2-logrotate:workerInterval 30
pm2 set pm2-logrotate:rotateInterval '0 0 0 * * * * *' # Rotate daily
```

### Что означает каждая команда настройки PM2 Logrotate:

- `pm2 set pm2-logrotate:max_size 1M`

  Устанавливает максимальный размер файла лога в 1 мегабайт. Когда лог достигает этого размера, он будет ротироваться.

- `pm2 set pm2-logrotate:retain 10`

  Сохраняет последние 10 ротированных логов и удаляет более старые для экономии дискового пространства.

- `pm2 set pm2-logrotate:compress true`

  Включает сжатие для ротированных логов, экономя место на диске.

- `pm2 set pm2-logrotate:dateFormat 'YYYY-MM-DD_HH-mm-ss'`

  Устанавливает формат временной метки в именах файлов логов: год-месяц-день_час-минута-секунда.

- `pm2 set pm2-logrotate:workerInterval 30`

  Рабочий процесс ротации логов проверяет каждые 30 секунд, нужно ли ротировать какой-либо лог по размеру.

- `pm2 set pm2-logrotate:rotateInterval '0 0 0 * * * * *'`

  Планирует ротацию логов ежедневно в полночь.

### Чтобы удалить pm2-logrotate без остановки сессий, выполните следующие шаги:

1. Отключите pm2-logrotate:
   ```
   pm2 set pm2-logrotate:enable false
   ```

2. Удалите pm2-logrotate:
   ```
   pm2 uninstall pm2-logrotate
   ```

Это удалит модуль pm2-logrotate без влияния на запущенные процессы PM2.